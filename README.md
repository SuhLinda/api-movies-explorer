Дипломный проект Yandex практикума

_ТЗ: Создайте схемы и модели ресурсов API_

В проекте две сущности: пользователи и сохранённые фильмы (users и movies). Создайте схему и модель для каждой. Саму базу данных назовите в единообразном формате, например /bitfilmsdb.

_Поля схемы user:_

_email_ — почта пользователя, по которой он регистрируется. Это обязательное поле, уникальное для каждого пользователя. Также оно должно валидироваться на соответствие схеме электронной почты.

_password_ — **хеш пароля. Обязательное поле-строка. Нужно задать поведение по умолчанию, чтобы база данных не возвращала это поле.

_name_ — имя пользователя, например: Александр или Мария. Это обязательное поле-строка от 2 до 30 символов.

_Поля схемы movie:_

_country_ — страна создания фильма. Обязательное поле-строка.

_director_ — режиссёр фильма. Обязательное поле-строка.

_duration_ — длительность фильма. Обязательное поле-число.

_year_ — год выпуска фильма. Обязательное поле-строка.

_description_ — описание фильма. Обязательное поле-строка.

_image_ — ссылка на постер к фильму. Обязательное поле-строка. Запишите её URL-адресом.

_trailerLink_ — ссылка на трейлер фильма. Обязательное поле-строка. Запишите её URL-адресом.

_thumbnail_ — миниатюрное изображение постера к фильму. Обязательное поле-строка. Запишите её URL-адресом.

_owner_ — _id пользователя, который сохранил фильм. Обязательное поле.

_movieId_ — id фильма, который содержится в ответе сервиса MoviesExplorer. Обязательное поле в формате number.

_nameRU_ — название фильма на русском языке. Обязательное поле-строка.

_nameEN_ — название фильма на английском языке. Обязательное поле-строка.

_Создайте роуты и контроллеры_

В API должно быть 5 роутов:

возвращает информацию о пользователе (email и имя)
_GET /users/me_

обновляет информацию о пользователе (email и имя)
_PATCH /users/me_

возвращает все сохранённые текущим пользователем фильмы
_GET /movies_

создаёт фильм с переданными в теле
country, director, duration, year, description, image, trailer, nameRU, nameEN и thumbnail, movieId
_POST /movies_

удаляет сохранённый фильм по id
_DELETE /movies/_id_

Создайте контроллер для каждого роута. Защитите роуты авторизацией: если клиент не прислал JWT, доступ к роутам ему должен быть закрыт.
Реализуйте аутентификацию и авторизацию

В API должно быть ещё два роута: для регистрации и логина.

создаёт пользователя с переданными в теле
email, password и name
_POST /signup_

проверяет переданные в теле почту и пароль
и возвращает JWT
_POST /signin_

Эти два роута не нужно защищать авторизацией.
Обратите внимание: если сохранять JWT в куках, понадобится дополнительный роут POST /signout. При запросе к роуту удалится JWT из куков пользователя.
Реализуйте логирование

Настройте два файла для хранения логов:
request.log, чтобы хранить информацию о всех запросах к API;
error.log, чтобы хранить информацию об ошибках, которые возвращает API.
Логи должны быть в формате JSON. Файлы логов не должны добавляться в репозиторий.
Деплой

Создайте сервер. Затем установите всё необходимое и разверните на нём API.  Важно реализовать возможность обращаться к API по публичному IP-адресу. Раньше мы обращались к серверу локально — по адресу localhost. Для разработки это нормально, но в продакшене не годится: к вашему localhost можете обратиться только вы. Поэтому сервер нужно где-то разместить.  Мы рекомендуем использовать Яндекс Облако для создания облачного сервера. Оно предоставляет грант для новых пользователей — что-то вроде бесплатного периода. Если вы уже пользовались Яндекс Облаком и входного гранта у вас нет, обратитесь к куратору.
Создайте домен и прикрепите его к серверу.  Закрепите за доменом публичный IP-адрес своего сервера. Подойдёт и бесплатный домен. Его вы можете зарегистрировать на нашем сервисе. Ссылку на него получите у куратора. Вы уже создавали домен в последнем спринте, сделайте это снова.  При разработке бэкенда принято выносить API на соответствующий поддомен api.* к основному домену, либо использовать префикс пути /api/ на том же домене, что и фронтенд.  Критерий готовности: к API можно обратиться по доменному имени.
Выпустите сертификаты и подключите их.  Должна быть возможность обратиться к серверу по https.
Создайте на сервере .env файл.  Добавьте в этот файл переменные окружения:  
NODE_ENV=production;
JWT_SECRET с секретным ключом для создания и верификации JWT.
.env файл должен храниться только на сервере. В репозитории хранить переменные окружения нельзя — это небезопасно.
В режиме разработки код должен запускаться и работать без этого файла. Задайте условие, чтобы dev-сборка запускалась, когда  process.env.NODE_ENV !== 'production'.
Расскажите, как найти ваш публичный сервер.  Добавьте в файл README.md домен, по которому можно обратиться к вашему серверу.


Repository: https://github.com/SuhLinda/movies-explorer-api

IP: 130.193.36.139

Backend: api.lindasux.nomoredomainsicu.ru

Frontend: lindasux.nomoredomainsicu.ru
